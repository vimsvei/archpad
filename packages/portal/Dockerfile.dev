# syntax=docker/dockerfile:1

# Minimal, predictable dev image.
# - source code is bind-mounted by docker-compose (../ -> /app)
# - node_modules live in docker volumes
# - pnpm store is mounted to speed up repeated installs

FROM node:20-bookworm-slim

ENV PNPM_HOME="/pnpm"
ENV PATH="$PNPM_HOME:$PATH"
ENV PNPM_STORE_PATH="/pnpm/store"

RUN corepack enable

WORKDIR /app

# Keep entrypoint inside the image; compose stays clean.
COPY packages/portal/docker-entrypoint.dev.sh /usr/local/bin/portal-dev
RUN chmod +x /usr/local/bin/portal-dev

ENV NODE_ENV=development
ENV NEXT_TELEMETRY_DISABLED=1
ENV PORT=3000
ENV HOSTNAME=0.0.0.0

EXPOSE 3000

ENTRYPOINT ["portal-dev"]


